#   mutate(race = "Total Pop.", propPark_Q = "Total Pop.")
#
#
# sf_park_income_gg <- sf_income_race_parkQ %>%
#   group_by(propPark_Q, income) %>%
#   summarize(Proportion = sum(Proportion)) %>%
#   rbind(sf_income_total) %>%
#   ggplot() +
#   geom_bar(
#     aes(
#       x = propPark_Q %>% factor(levels = rev(c("Total Pop.",unique(sf_income_race_parkQ$propPark_Q)))),
#       y = Proportion,
#       fill = income %>% factor(levels = rev(unique(sf_income_race_parkQ$income)))
#     ),
#     stat = "identity",
#     position = "fill"
#   ) +
#   labs(
#     x = "Park Quartile",
#     y = "Proportion of Households",
#     title = "San Francisco Park Proportion of Tract by Household Income",
#     fill = "Household Income Bracket"
#   )
#
# sf_park_income <- ggplotly(sf_park_income_gg, tooltip="y")
#
# sf_park_income
# Chunk 8
# mutate to larger buckets for cleaner plot
sf_income_race_parkQ <- sf_income_race_parkQ %>%
mutate(
income1 = income,
income = case_when(
income == "Less than $10,000" | income == "$10,000 to $14,999"
~ "Less than $15,000",
income == "$15,000 to $19,999" | income == "$20,000 to $24,999" |
income == "$25,000 to $29,999"
~ "$15,000 to $29,999",
income == "$30,000 to $34,999" | income == "$35,000 to $39,999" |
income == "$40,000 to $44,999"
~ "$30,000 to $44,999",
income == "$45,000 to $49,999" | income == "$50,000 to $59,999"
~ "$45,000 to $59,999",
TRUE ~ income,
)
)
sf_income_total <-
sf_income_race_parkQ %>%
group_by(income) %>%
summarize(Proportion = sum(Proportion)) %>%
mutate(race = "Total Pop.", propPark_Q = "Total Pop.")
sf_park_income_gg <- sf_income_race_parkQ %>%
group_by(propPark_Q, income) %>%
summarize(Proportion = sum(Proportion)) %>%
rbind(sf_income_total) %>%
ggplot() +
geom_bar(
aes(
x = propPark_Q %>% factor(levels = rev(c("Total Pop.",unique(sf_income_race_parkQ$propPark_Q)))),
y = Proportion,
fill = income %>% factor(levels = rev(unique(sf_income_race_parkQ$income)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Park Quartile",
y = "Proportion of Households",
title = "San Francisco Park Proportion of Tract by Household Income",
fill = "Household Income"
)
sf_park_income <- ggplotly(sf_park_income_gg, tooltip="y")
sf_park_income
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
knitr::opts_chunk$set(echo = F, warning = F, message = F)
prsn_data <- read_csv("data/data_with_personalities.csv")
View(prsn_data)
colname(prsn_data)
col_name(prsn_data)
colnames(prsn_data)
prsn_data_full <- read_csv("data/data_with_personalities.csv")
prsn_data <- prsn_data_full %>% select("id","prolific_id", "c_time_in_nature_daysweek", "c_time_in_nature_hoursday", "pc_time_in_nature_daysweek", "pc_time_in_nature_hoursday", "pc_total_time_nature", "parkareaperperson_nq", "totalstress", "highconscientiousness", "lowconscientiousness", "highopenness", "lowopenness", "highextraversion", "lowextraversion")
prsn_data_full <- read_csv("data/data_with_personalities.csv")
setwd("~/Documents/GitHub/Fall_2021_Research_GSandMH")
prsn_data_full <- read_csv("data/data_with_personalities.csv")
prsn_data <- prsn_data_full %>% select("id","prolific_id", "c_time_in_nature_daysweek", "c_time_in_nature_hoursday", "pc_time_in_nature_daysweek", "pc_time_in_nature_hoursday", "pc_total_time_nature", "parkareaperperson_nq", "totalstress", "highconscientiousness", "lowconscientiousness", "highopenness", "lowopenness", "highextraversion", "lowextraversion")
prsn_data_full <- read_csv("data/data_with_personalities.csv")
prsn_data <- prsn_data_full %>% select("id","prolific_id", "c_time_in_nature_daysweek", "c_time_in_nature_hoursday", "c_time_nature_total", "pc_time_in_nature_daysweek", "pc_time_in_nature_hoursday", "pc_total_time_nature", "parkareaperperson_nq", "totalstress","totalstress1cat", "highconscientiousness", "lowconscientiousness", "highemotional", "lowemotional", "highagreeableness", "lowagreeableness", "highopenness", "lowopenness", "highextraversion", "lowextraversion")
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
ggplot() +
geom_boxplot(
aes(
x = conscientiousness,
y = c_time_in_nature_daysweek,
)) +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
View(prsn_nature_data)
check<-prsn_nature_data %>% select(conscientiousness, highconscientiousness, lowconscientiousness)
View(check)
# Chunk 1: setup
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# Chunk 2: libraries
library(tidyverse)
# Chunk 3: LoadData
tracts_nature <- read_csv("data/nanda_parks_tract_2018_01P.csv")
tracts_to_zip <- read_csv("data/zcta_tract_rel_10.csv")
zips_of_interest <- read_csv("data/NaturalElementsSpatialAnalysis - ZipCodes.csv") %>%
select(Prolific_ID, Frst_HomeZip = D_Home_Location, Scnd_HomeZip = "2D_Home_Location",
Frst_WorkZip = D_Work_Location, Scnd_WorkZip = "2D_Work_Location")
# Chunk 4: ManipulateParkData
tracts_nature_avg <-
tracts_nature %>%
mutate(parks_per_area = count_open_parks / tract_area,
GEOID = as.numeric(tract_fips10)
) %>%
select(GEOID, parks_per_area, prop_park_area_tract)
# Chunk 5: ZipParks
zip_parks <-
tracts_to_zip %>%
select(ZipCode = ZCTA5, GEOID, ZAREA, ZAREAPCT) %>%
left_join(tracts_nature_avg) %>%
mutate(
tractparks_inzip = parks_per_area * ZAREA * ZAREAPCT/100,
tractparkarea_inzip = prop_park_area_tract * ZAREA * ZAREAPCT/100
) %>%
group_by(ZipCode) %>%
summarize(
parks_inzip = sum(tractparks_inzip, na.rm = T),
parkarea_inzip = sum(tractparkarea_inzip, na.rm = T),
ZAREA = ZAREA
) %>%
mutate(
prop_parkarea_inzip = parkarea_inzip / ZAREA * 100
)
# Chunk 6: SubjectsPark
subject_park_exposure <-
zips_of_interest %>%
pivot_longer(
cols = c("Frst_HomeZip", "Frst_WorkZip", "Scnd_HomeZip", "Scnd_WorkZip"),
names_to = "location",
values_to = "ZipCode"
) %>%
left_join(zip_parks) %>%
group_by(location) %>%
unique()
# Chunk 7: SummaryStats
sum_stats <-
subject_park_exposure %>%
group_by(location) %>%
summarize(
avg_parks = mean(parks_inzip, na.rm = T),
avg_parkarea = mean(parkarea_inzip, na.rm = T),
avg_prop_parkarea = mean(prop_parkarea_inzip, na.rm = T))
# Chunk 8: plotTotalParks
total_parks_boxplot <-
subject_park_exposure %>%
ggplot() +
geom_boxplot(
aes(
x = location,
y = parks_inzip,
)) +
labs(
x = "Location",
y = "Parks",
title = "Total Parks in Respondents' Zip Codes \n",
)
total_parks_boxplot
# Chunk 9: plotParkArea
total_parkarea_boxplot <-
subject_park_exposure %>%
ggplot() +
geom_boxplot(
aes(
x = location,
y = parkarea_inzip,
)) +
labs(
x = "Location",
y = "Park Area [m^2]",
title = "Park Area in Respondents' Zip Codes \n",
)+
ylim(0, 10000000)
total_parkarea_boxplot
# Chunk 10: plotPropParkArea
total_prop_parkarea_boxplot <-
subject_park_exposure %>%
ggplot() +
geom_boxplot(
aes(
x = location,
y = prop_parkarea_inzip,
)) +
labs(
x = "Location",
y = "Proportion of Zip Code Area in Parks (%)",
title = "Proportion of Park Area in Respondents' Zip Codes  \n",
)
total_prop_parkarea_boxplot
# Chunk 11: filterWfH
subject_park_exposure_noWfH <-
zips_of_interest %>%
filter( !(`Scnd_HomeZip` == `Scnd_WorkZip`)
)%>%
pivot_longer(
cols = c("Frst_HomeZip", "Frst_WorkZip", "Scnd_HomeZip", "Scnd_WorkZip"),
names_to = "location",
values_to = "ZipCode"
) %>%
left_join(zip_parks) %>%
group_by(location) %>%
unique()
# Chunk 12: plotTotalParks
total_parks_boxplot_noWfH <-
subject_park_exposure_noWfH %>%
ggplot() +
geom_boxplot(
aes(
x = location,
y = parks_inzip,
)) +
labs(
x = "Location",
y = "Parks",
title = "Total Parks in Respondents' Zip Codes \n (Exclude Work From Home on Second Survey)",
)
total_parks_boxplot_noWfH
# Chunk 13: plotParkArea
total_parkarea_boxplot_noWfH <-
subject_park_exposure_noWfH %>%
ggplot() +
geom_boxplot(
aes(
x = location,
y = parkarea_inzip,
)) +
labs(
x = "Location",
y = "Park Area [m^2]",
title = "Park Area in Respondents' Zip Codes \n (Exclude Work From Home on Second Survey)",
)+
ylim(0, 10000000)
total_parkarea_boxplot_noWfH
# Chunk 14: plotPropParkArea
total_prop_parkarea_boxplot_noWfH <-
subject_park_exposure_noWfH %>%
ggplot() +
geom_boxplot(
aes(
x = location,
y = prop_parkarea_inzip,
)) +
labs(
x = "Location",
y = "Proportion of Zip Code Area in Parks (%)",
title = "Proportion of Park Area in Respondents' Zip Codes \n (Exclude Work From Home on Second Survey)",
)
total_prop_parkarea_boxplot_noWfH
View(subject_park_exposure_noWfH)
# Chunk 1: setup
knitr::opts_chunk$set(echo = F, warning = F, message = F)
# Chunk 2: libraries
library(tidyverse)
# Chunk 3
prsn_data_full <- read_csv("data/data_with_personalities.csv")
prsn_data <- prsn_data_full %>% select("id","prolific_id", "c_time_in_nature_daysweek", "c_time_in_nature_hoursday", "c_time_nature_total", "pc_time_in_nature_daysweek", "pc_time_in_nature_hoursday", "pc_total_time_nature", "parkareaperperson_nq", "totalstress","totalstress1cat", "highconscientiousness", "lowconscientiousness", "highemotional", "lowemotional", "highagreeableness", "lowagreeableness", "highopenness", "lowopenness", "highextraversion", "lowextraversion")
# Chunk 4: personality and nature
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
ggplot() +
geom_boxplot(
aes(
x = conscientiousness,
y = c_time_in_nature_daysweek,
)) +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
rlang::last_error()
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
ggplot() +
geom_boxplot(
aes_string(
x = conscientiousness,
y = c_time_in_nature_daysweek,
)) +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ 1,
lowconscientiousness == 1 ~ -1
)
)
consc_natureDays <-
prsn_nature_data %>%
ggplot() +
geom_boxplot(
aes(
x = conscientiousness,
y = c_time_in_nature_daysweek,
)) +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
ggplot() +
geom_boxplot(
aes(
x = 'conscientiousness',
y = 'c_time_in_nature_daysweek',
)) +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
ggplot() +
geom_boxplot(
aes(
x = conscientiousness,
y = c_time_in_nature_daysweek
)) +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
ggplot(data=prsn_nature_data,aes_string(x='conscientiousness',y='c_time_in_nature_daysweek')) +
geom_boxplot() +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
filter(!is.na(conscientiousness)) %>%
ggplot(
aes_string( x = 'conscientiousness', y = 'c_time_in_nature_daysweek')) +
geom_boxplot() +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape = NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
filter(!is.na(conscientiousness)) %>%
ggplot(
aes_string( x = 'conscientiousness', y = 'c_time_in_nature_daysweek')) +
geom_boxplot() +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot()
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
filter(!is.na(conscientiousness)) %>%
ggplot(
aes_string( x = 'conscientiousness', y = 'c_time_in_nature_daysweek')) +
geom_boxplot() +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape=NA)
consc_natureDays
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
consc_natureDays <-
prsn_nature_data %>%
filter(!is.na(conscientiousness)) %>%
ggplot(
aes_string( x = 'conscientiousness', y = 'c_time_in_nature_daysweek')) +
geom_boxplot() +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.color=NA)
consc_natureDays
sts_natureDay <- boxplot.stats(prsn_nature_data$c_time_in_nature_daysweek)$stats
prsn_nature_data <- prsn_data %>%
mutate(
conscientiousness = case_when(
highconscientiousness == 1 ~ "High",
lowconscientiousness == 1 ~ "Low"
)
)
sts_natureDay <- boxplot.stats(prsn_nature_data$c_time_in_nature_daysweek)$stats
consc_natureDays <-
prsn_nature_data %>%
filter(!is.na(conscientiousness)) %>%
ggplot(
aes_string( x = 'conscientiousness', y = 'c_time_in_nature_daysweek')) +
geom_boxplot() +
labs(
x = "Conscientiousness",
y = "Number of Days with Tim Spent in Nature",
title = "Days in Nature by Conscientiousness",
)+
geom_boxplot(outlier.shape=NA)
consc_natureDays
